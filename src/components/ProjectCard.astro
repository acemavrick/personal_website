---
import type { Project } from '../types/project';

interface Props {
  project: Project;
  handedness: "left" | "right";
}

const { project, handedness = "right" } = Astro.props;

// map image_fit to tailwind classes (avoid dynamic class purge)
const objectFitClass = (
  project.image_fit === 'contain' ? 'object-contain' :
  project.image_fit === 'fill' ? 'object-fill' :
  project.image_fit === 'none' ? 'object-none' :
  project.image_fit === 'scale-down' ? 'object-scale-down' :
  'object-cover'
);
---

<article class="not-prose overflow-hidden rounded-xl transition hover:shadow-lg">
    <div class="grid items-center gap-6 p-4 md:grid-cols-12 md:p-6">
        {project.image && handedness === 'left' && (
            <div class="md:col-span-5">
                <div class="relative aspect-[16/10] overflow-hidden rounded-lg">
                    <img
                        src={project.image}
                        alt={project.image_alt ?? `${project.title} preview`}
                        class={`absolute inset-0 h-full w-full ${objectFitClass}`}
                        loading="lazy"
                        decoding="async"
                        sizes="(min-width: 1024px) 480px, (min-width: 768px) 40vw, 100vw"
                    />
                </div>
            </div>
        )}
        <div class="md:col-span-7">
            <h2 class="text-2xl font-semibold tracking-tight text-slate-900 dark:text-white">{project.title}</h2>
            {project.tags && project.tags.length > 0 && (
                <div class="mt-3 flex flex-wrap gap-2">
                    {project.tags.map((tag: string) => (
                        <span class="inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2.5 py-0.5 text-xs font-medium text-emerald-700 dark:border-emerald-900/50 dark:bg-emerald-900/30 dark:text-emerald-300">{tag}</span>
                    ))}
                </div>
            )}

            <p class="mt-3 text-slate-700 dark:text-slate-300">{project.description}</p>
            {project.url && (
                <a
                    href={project.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Open ${project.title}`}
                    class="mt-4 inline-flex items-center gap-2 rounded-lg bg-teal-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-teal-700 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600"
                >
                    View Project <span aria-hidden>â†’</span>
                </a>
            )}
        </div>
        {project.image && handedness === 'right' && (
            <div class="md:col-span-5">
                <div class="relative aspect-[16/10] overflow-hidden rounded-lg">
                    <img
                        src={project.image}
                        alt={project.image_alt ?? `${project.title} preview`}
                        class={`absolute inset-0 h-full w-full ${objectFitClass}`}
                        loading="lazy"
                        decoding="async"
                        sizes="(min-width: 1024px) 480px, (min-width: 768px) 40vw, 100vw"
                    />
                </div>
            </div>
        )}
    </div>
</article>